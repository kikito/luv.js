<!DOCTYPE html>

<html>
<head>
  <title>mouse.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="CONTRIBUTING.html">
                CONTRIBUTING.md
              </a>
            
              
              <a class="source" href="MIT-LICENSE.html">
                MIT-LICENSE.md
              </a>
            
              
              <a class="source" href="index.html">
                README.js.md
              </a>
            
              
              <a class="source" href="audio.html">
                audio.js
              </a>
            
              
              <a class="source" href="null_sound.html">
                audio/null_sound.js
              </a>
            
              
              <a class="source" href="sound.html">
                audio/sound.js
              </a>
            
              
              <a class="source" href="sound_instance.html">
                audio/sound_instance.js
              </a>
            
              
              <a class="source" href="core.html">
                core.js
              </a>
            
              
              <a class="source" href="graphics.html">
                graphics.js
              </a>
            
              
              <a class="source" href="animation.html">
                graphics/animation.js
              </a>
            
              
              <a class="source" href="canvas.html">
                graphics/canvas.js
              </a>
            
              
              <a class="source" href="image.html">
                graphics/image.js
              </a>
            
              
              <a class="source" href="sprite.html">
                graphics/sprite.js
              </a>
            
              
              <a class="source" href="sprite_sheet.html">
                graphics/sprite_sheet.js
              </a>
            
              
              <a class="source" href="keyboard.html">
                keyboard.js
              </a>
            
              
              <a class="source" href="media.html">
                media.js
              </a>
            
              
              <a class="source" href="mouse.html">
                mouse.js
              </a>
            
              
              <a class="source" href="timer.html">
                timer.js
              </a>
            
              
              <a class="source" href="after.html">
                timer/after.js
              </a>
            
              
              <a class="source" href="every.html">
                timer/every.js
              </a>
            
              
              <a class="source" href="tween.html">
                timer/tween.js
              </a>
            
              
              <a class="source" href="touch.html">
                touch.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap for-h1">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1>mouse.js</h1>

            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="keyword">function</span>() {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2>Luv.Mouse</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>Luv.Mouse = Luv.Class(<span class="string">'Luv.Mouse'</span>, {</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>This function creates a mouse handler for a mouse game.
It is usually instantiated directly by the main Luv() function,
you will probably not need to call <code>Luv.Mouse()</code> yourself:</p>
<pre><code>  var luv = Luv();
  luv.mouse // Already instantiated mouse handler</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  init: <span class="keyword">function</span>(el) {

    <span class="keyword">var</span> mouse  = <span class="keyword">this</span>;

    mouse.x               = <span class="number">0</span>;
    mouse.y               = <span class="number">0</span>;
    mouse.pressedButtons  = {};
    mouse.wheelTimeOuts   = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>The mouse module works by attaching several event listeners to the
given el element. That&#39;s how mouse position, button presses and wheel state
are detected.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> handlePress = <span class="keyword">function</span>(button) {
      mouse.pressedButtons[button] = <span class="literal">true</span>;
      mouse.onPressed(mouse.x, mouse.y, button);
    };

    <span class="keyword">var</span> handleRelease = <span class="keyword">function</span>(button) {
      mouse.pressedButtons[button] = <span class="literal">false</span>;
      mouse.onReleased(mouse.x, mouse.y, button);
    };

    <span class="keyword">var</span> handleWheel = <span class="keyword">function</span>(evt) {
      evt.preventDefault();
      <span class="keyword">var</span> button = getWheelButtonFromEvent(evt);</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>The &#39;wheel has stopped scrolling&#39; event is triggered via setTimeout, since
browsers don&#39;t provide a native &#39;stopped scrolling&#39; event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      clearTimeout(mouse.wheelTimeOuts[button]);
      mouse.wheelTimeOuts[button] = setTimeout(<span class="keyword">function</span>() {
        handleRelease(button);
      }, Luv.Mouse.WHEEL_TIMEOUT * <span class="number">1000</span>);
      handlePress(button);
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>mousemove is particularly laggy in Chrome. I&#39;d love to find a better solution</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    el.addEventListener(<span class="string">'mousemove'</span>, <span class="keyword">function</span>(evt) {
      <span class="keyword">var</span> rect = el.getBoundingClientRect();
      mouse.x = evt.pageX - rect.left;
      mouse.y = evt.pageY - rect.top;
      mouse.onMoved(mouse.x, mouse.y);
    });

    el.addEventListener(<span class="string">'mousedown'</span>, <span class="keyword">function</span>(evt) {
      handlePress(getButtonFromEvent(evt));
    });

    el.addEventListener(<span class="string">'mouseup'</span>, <span class="keyword">function</span>(evt) {
      handleRelease(getButtonFromEvent(evt));
    });

    el.addEventListener(<span class="string">'DOMMouseScroll'</span>, handleWheel); <span class="comment">// firefox</span>
    el.addEventListener(<span class="string">'mousewheel'</span>, handleWheel); <span class="comment">// everyone else</span>
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Returns the x coordinate where the mouse is (relative to the DOM element)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  getX: <span class="keyword">function</span>() { <span class="keyword">return</span> <span class="keyword">this</span>.x; },</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Returns the x coordinate where the mouse is (relative to the DOM element)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  getY: <span class="keyword">function</span>() { <span class="keyword">return</span> <span class="keyword">this</span>.y; },</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Returns both the x and y coordinates of the mouse, as an object of the form
`{x: 100, y:200}</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  getPosition: <span class="keyword">function</span>() {
    <span class="keyword">return</span> {x: <span class="keyword">this</span>.x, y: <span class="keyword">this</span>.y};
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p><code>onPressed</code> is an overridable callback that is called when any of the mouse
buttons is pressed.
<code>button</code> is a string representing a button name (<code>&quot;l&quot;</code> for left, <code>&quot;m&quot;</code> for middle,
<code>&quot;r&quot;</code> for right).</p>
<pre><code>  var luv = Luv();
  luv.mouse.onPressed = function(x,y,button) {
    console.log(&quot;Mouse button &quot; + button + &quot; was pressed in &quot; + x + &quot;, &quot; + y);
  }</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  onPressed: <span class="keyword">function</span>(x,y,button) {},</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Works the same as <code>onPressed</code>, but is called when a button stops being pressed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  onReleased: <span class="keyword">function</span>(x,y,button) {},

  onMoved: <span class="keyword">function</span>(x,y) {},</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Returns true if a button is pressed, false otherwhise. Usually used inside
the update loop:</p>
<pre><code>  var luv = Luv();
  luv.update = function(dt) {
    if(luv.mouse.isPressed(&#39;l&#39;)) {
      console.log(&#39;Left mouse button pressed&#39;);
    }
  };</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  isPressed: <span class="keyword">function</span>(button) {
    <span class="keyword">return</span> !!<span class="keyword">this</span>.pressedButtons[button];
  }
});</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>The mouse considers it has stopped scrolling after 20ms</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Luv.Mouse.WHEEL_TIMEOUT = <span class="number">0.02</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Internal variable + function to transform DOM event magic numbers into human button names
(left, middle, right)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> mouseButtonNames = {<span class="number">1</span>: <span class="string">"l"</span>, <span class="number">2</span>: <span class="string">"m"</span>, <span class="number">3</span>: <span class="string">"r"</span>};
<span class="keyword">var</span> getButtonFromEvent = <span class="keyword">function</span>(evt) {
  <span class="keyword">return</span> mouseButtonNames[evt.which];
};</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Internal function to determine the mouse weel direction</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> getWheelButtonFromEvent = <span class="keyword">function</span>(evt) {
  <span class="keyword">var</span> delta = Math.max(-<span class="number">1</span>, Math.min(<span class="number">1</span>, (evt.wheelDelta || -evt.detail)));
  <span class="keyword">return</span> delta === <span class="number">1</span> ? <span class="string">'wu'</span> : <span class="string">'wd'</span>;
};

}());</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
