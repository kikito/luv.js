<!DOCTYPE html>

<html>
<head>
  <title>keyboard.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="CONTRIBUTING.html">
                CONTRIBUTING.md
              </a>
            
              
              <a class="source" href="MIT-LICENSE.html">
                MIT-LICENSE.md
              </a>
            
              
              <a class="source" href="index.html">
                README.js.md
              </a>
            
              
              <a class="source" href="audio.html">
                audio.js
              </a>
            
              
              <a class="source" href="null_sound.html">
                audio/null_sound.js
              </a>
            
              
              <a class="source" href="sound.html">
                audio/sound.js
              </a>
            
              
              <a class="source" href="sound_instance.html">
                audio/sound_instance.js
              </a>
            
              
              <a class="source" href="core.html">
                core.js
              </a>
            
              
              <a class="source" href="graphics.html">
                graphics.js
              </a>
            
              
              <a class="source" href="animation.html">
                graphics/animation.js
              </a>
            
              
              <a class="source" href="canvas.html">
                graphics/canvas.js
              </a>
            
              
              <a class="source" href="image.html">
                graphics/image.js
              </a>
            
              
              <a class="source" href="sprite.html">
                graphics/sprite.js
              </a>
            
              
              <a class="source" href="sprite_sheet.html">
                graphics/sprite_sheet.js
              </a>
            
              
              <a class="source" href="keyboard.html">
                keyboard.js
              </a>
            
              
              <a class="source" href="media.html">
                media.js
              </a>
            
              
              <a class="source" href="mouse.html">
                mouse.js
              </a>
            
              
              <a class="source" href="shims.html">
                shims.js
              </a>
            
              
              <a class="source" href="timer.html">
                timer.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap for-h1">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1>keyboard.js</h1>

            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="keyword">function</span>() {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2>Luv.Keyboard</h2>
<p>This class encapsulates the functionality which has to do with keyboard handling in Luv.</p>
<p><em>Disclaimer</em>: the code on this module was inspired by <a href="http://www.selfcontained.us/2009/09/16/getting-keycode-values-in-javascript/">selfcontained.us</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Luv.Keyboard = Luv.Class(<span class="string">'Luv.Keyboard'</span>, {</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>You will almost never need to instantiate this Luv module manually. Instead,
you will create a <code>Luv</code> object, which will have a <code>keyboard</code> attribute. For
example:</p>
<pre><code>   var luv = Luv();
   luv.keyboard // You will use this</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  init: <span class="keyword">function</span>(el) {
    <span class="keyword">var</span> keyboard = <span class="keyword">this</span>;

    keyboard.keysDown  = {};
    keyboard.el        = el;

    el.addEventListener(<span class="string">'keydown'</span>, <span class="keyword">function</span>(evt) {
      evt.preventDefault();
      evt.stopPropagation();

      <span class="keyword">var</span> key  = getKeyFromEvent(evt);
      keyboard.keysDown[key] = <span class="literal">true</span>;
      keyboard.onPressed(key, evt.which);
    });

    el.addEventListener(<span class="string">'keyup'</span>, <span class="keyword">function</span>(evt) {
      evt.preventDefault();
      evt.stopPropagation();

      <span class="keyword">var</span> key  = getKeyFromEvent(evt);
      keyboard.keysDown[key] = <span class="literal">false</span>;
      keyboard.onReleased(key, evt.which);
    });

    <span class="keyword">return</span> keyboard;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p><code>onPressed</code> is a user-overrideable that is triggered when a keyboard key
is pressed.</p>
<p>The first parameter is a string with the key human name (for example the
arrow keys are named &quot;up&quot;, &quot;down&quot;, &quot;left&quot; and &quot;right&quot;). The second parameter
is a number that browsers use internally to identify keys. I&#39;ve included both
because there is no way I can name all keys that exist (the list of key names
that luv.js understands is below).</p>
<p>Example of use of onPressed:</p>
<pre><code>  var msg = &quot;&quot;;
  var luv = Luv();
  luv.keyboard.onPressed = function(key, code) {
    msg = &quot;The key &quot; + key + &quot; with code &quot; + code + &quot; was pressed&quot;;
  };</code></pre>
<p>It does nothing by default.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  onPressed  : <span class="keyword">function</span>(key, code) {},</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p><code>onReleased</code> works the same way as onPressed, except that it gets triggered
when a key stops being pressed.</p>
<p>Similarly to <code>onPressed</code>, the first parameter is a key name, while the second
one is the browser&#39;s internal keycode (a number).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  onReleased : <span class="keyword">function</span>(key, code) {},</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p><code>isDown</code> will return true if a key is pressed, and false otherwise.
If used, it will probably be used inside <code>luv.update</code>:</p>
<pre><code>  var player = {y: 100};
  var luv = Luv();
  luv.update = function(dt) {
    if(luv.keyboard.isPressed(&#39;up&#39;)) {
      player.y -= 10*dt;
    };
  };</code></pre>
<p>Notice that while using <code>isDown</code> is easier than using <code>onPressed</code> and <code>onReleased</code>,
it is also less flexible. On medium games that allow things like keyboard configuration,
it&#39;s recommended to use <code>onPressed</code> and <code>onReleased</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  isDown     : <span class="keyword">function</span>(key) {
    <span class="keyword">return</span> !!<span class="keyword">this</span>.keysDown[key];
  }
});</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h2>key names</h2>
<p>This object contains the names used for each key code. Notice that this is not a
comprehensive list; common ASCII characters like &#39;a&#39;, which can be calculated via
<code>String.fromCharCode</code>, are not included here.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> keys = {
  <span class="number">8</span>: <span class="string">"backspace"</span>,
  <span class="number">9</span>: <span class="string">"tab"</span>,
  <span class="number">13</span>: <span class="string">"enter"</span>,
  <span class="number">16</span>: <span class="string">"shift"</span>,
  <span class="number">17</span>: <span class="string">"ctrl"</span>,
  <span class="number">18</span>: <span class="string">"alt"</span>,
  <span class="number">19</span>: <span class="string">"pause"</span>, <span class="number">20</span>: <span class="string">"capslock"</span>, <span class="number">27</span>: <span class="string">"escape"</span>,
  <span class="number">33</span>: <span class="string">"pageup"</span>, <span class="number">34</span>: <span class="string">"pagedown"</span>, <span class="number">35</span>: <span class="string">"end"</span>, <span class="number">36</span>: <span class="string">"home"</span>, <span class="number">45</span>: <span class="string">"insert"</span>, <span class="number">46</span>: <span class="string">"delete"</span>,
  <span class="number">37</span>: <span class="string">"left"</span>, <span class="number">38</span>: <span class="string">"up"</span>, <span class="number">39</span>: <span class="string">"right"</span>, <span class="number">40</span>: <span class="string">"down"</span>,
  <span class="number">91</span>: <span class="string">"lmeta"</span>, <span class="number">92</span>: <span class="string">"rmeta"</span>, <span class="number">93</span>: <span class="string">"mode"</span>,
  <span class="number">96</span>: <span class="string">"kp0"</span>, <span class="number">97</span>: <span class="string">"kp1"</span>, <span class="number">98</span>: <span class="string">"kp2"</span>, <span class="number">99</span>: <span class="string">"kp3"</span>, <span class="number">100</span>: <span class="string">"kp4"</span>, <span class="number">101</span>: <span class="string">"kp5"</span>,
  <span class="number">102</span>: <span class="string">"kp6"</span>, <span class="number">103</span>: <span class="string">"kp7"</span>, <span class="number">104</span>: <span class="string">"kp8"</span>, <span class="number">105</span>: <span class="string">"kp9"</span>,
  <span class="number">106</span>: <span class="string">"kp*"</span>, <span class="number">107</span>: <span class="string">"kp+"</span>, <span class="number">109</span>: <span class="string">"kp-"</span>, <span class="number">110</span>: <span class="string">"kp."</span>, <span class="number">111</span>: <span class="string">"kp/"</span>,
  <span class="number">112</span>: <span class="string">"f1"</span>, <span class="number">113</span>: <span class="string">"f2"</span>, <span class="number">114</span>: <span class="string">"f3"</span>, <span class="number">115</span>: <span class="string">"f4"</span>, <span class="number">116</span>: <span class="string">"f5"</span>, <span class="number">117</span>: <span class="string">"f6"</span>, <span class="number">118</span>: <span class="string">"f7"</span>,
  <span class="number">119</span>: <span class="string">"f8"</span>, <span class="number">120</span>: <span class="string">"f9"</span>, <span class="number">121</span>: <span class="string">"f10"</span>, <span class="number">122</span>: <span class="string">"f11"</span>, <span class="number">123</span>: <span class="string">"f12"</span>,
  <span class="number">144</span>: <span class="string">"numlock"</span>, <span class="number">145</span>: <span class="string">"scrolllock"</span>,
  <span class="number">186</span>: <span class="string">","</span>, <span class="number">187</span>: <span class="string">"="</span>, <span class="number">188</span>: <span class="string">","</span>, <span class="number">189</span>: <span class="string">"-"</span>, <span class="number">190</span>: <span class="string">"."</span>, <span class="number">191</span>: <span class="string">"/"</span>, <span class="number">192</span>: <span class="string">"`"</span>,
  <span class="number">219</span>: <span class="string">"["</span>, <span class="number">220</span>: <span class="string">"\\"</span>,<span class="number">221</span>: <span class="string">"]"</span>, <span class="number">222</span>: <span class="string">"'"</span>
};</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h2>Shifted key names</h2>
<p>These names will get passed to onPress and onRelease instead of the default ones
if one of the two &quot;shift&quot; keys is pressed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> shiftedKeys = {
  <span class="number">192</span>:<span class="string">"~"</span>, <span class="number">48</span>:<span class="string">")"</span>, <span class="number">49</span>:<span class="string">"!"</span>, <span class="number">50</span>:<span class="string">"@"</span>, <span class="number">51</span>:<span class="string">"#"</span>, <span class="number">52</span>:<span class="string">"$"</span>, <span class="number">53</span>:<span class="string">"%"</span>, <span class="number">54</span>:<span class="string">"^"</span>, <span class="number">55</span>:<span class="string">"&amp;"</span>, <span class="number">56</span>:<span class="string">"*"</span>, <span class="number">57</span>:<span class="string">"("</span>, <span class="number">109</span>:<span class="string">"_"</span>, <span class="number">61</span>:<span class="string">"+"</span>,
  <span class="number">219</span>:<span class="string">"{"</span>, <span class="number">221</span>:<span class="string">"}"</span>, <span class="number">220</span>:<span class="string">"|"</span>, <span class="number">59</span>:<span class="string">":"</span>, <span class="number">222</span>:<span class="string">"\""</span>, <span class="number">188</span>:<span class="string">"&lt;"</span>, <span class="number">189</span>:<span class="string">"&gt;"</span>, <span class="number">191</span>:<span class="string">"?"</span>,
  <span class="number">96</span>:<span class="string">"insert"</span>, <span class="number">97</span>:<span class="string">"end"</span>, <span class="number">98</span>:<span class="string">"down"</span>, <span class="number">99</span>:<span class="string">"pagedown"</span>, <span class="number">100</span>:<span class="string">"left"</span>, <span class="number">102</span>:<span class="string">"right"</span>, <span class="number">103</span>:<span class="string">"home"</span>, <span class="number">104</span>:<span class="string">"up"</span>, <span class="number">105</span>:<span class="string">"pageup"</span>
};</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2>Right keys</h2>
<p>luv.js will attempt to differentiate rshift from shift, rctrl from ctrl, and
ralt from alt. This is browser-dependent though, and not completely supported.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> rightKeys = {
  <span class="number">16</span>: <span class="string">"rshift"</span>, <span class="number">17</span>: <span class="string">"rctrl"</span>, <span class="number">18</span>: <span class="string">"ralt"</span>
};</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>This function tries to guess the best name for a event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> getKeyFromEvent = <span class="keyword">function</span>(event) {</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Getting the keybode is easy</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> code = event.which;
  <span class="keyword">var</span> key;</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>See if we are pressing one of the &quot;right keys&quot;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">if</span>(event.keyLocation &amp;&amp; event.keyLocation &gt; <span class="number">1</span>) { key = rightKeys[code]; }</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>otherwise see if we are pressing shift</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">else</span> <span class="keyword">if</span>(event.shiftKey) { key = shiftedKeys[code] || keys[code]; }</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>otherwise, it&#39;s a &quot;non-special&quot; key, Try to get its name from the <code>keys</code> var.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">else</span> { key = keys[code]; }</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>If everything else fails, try to return <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/fromCharCode">String.fromCharCode</a>
That will return &quot;normal letters&quot;, such as &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, etc.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">if</span>(<span class="keyword">typeof</span> key === <span class="string">"undefined"</span>) {
    key = String.fromCharCode(code);
    <span class="keyword">if</span>(event.shiftKey) { key = key.toUpperCase(); }
  }

  <span class="keyword">return</span> key;
};

}());</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
