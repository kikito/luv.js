<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Situation is FUBAR</title>
  <script src="../luv.js"></script>
</head>
<body>
  <script>

    var luv = Luv();

    var fighters, lockHeed, hydro, lockHeedAngle, hydroAngle, submarine;

    luv.load = function() {
      var img = luv.graphics.Image('img/1945.png');
                                            // sprite size, offset, border
      var s32 = luv.graphics.SpriteSheet(img,     32,32,     3,3,    1);

      fighters = [ //   x     y     frame delay
        s32.Animation(['0-7', 0],   0.1),
        s32.Animation(['0-7', 1],   0.2),
        s32.Animation(['0-7', 2],   0.3),
        s32.Animation(['0-7', 3],   0.4),
        s32.Animation(['0-7', 4],   0.5),

                  //   x1    y1    x2   y2     frame delay
        s32.Animation([17, '6-10', 17, '9-7'], 0.6),
        s32.Animation([18, '6-10', 18, '9-7'], 0.7),
        s32.Animation([19, '6-10', 19, '9-7'], 0.8),
        s32.Animation([20, '6-10', 20, '9-7'], 0.9)
      ];

                                            // sprite size, offset, border
      var s65 = luv.graphics.SpriteSheet(img,     65,65,     300,102, 1);

      lockHeed = s65.Animation([0, '0-2'], 0.1);
      hydro    = s65.Animation(['1-3', 2], 0.1);

      lockHeedAngle = 0;
      hydroAngle    = 0;

      var sSub = luv.graphics.SpriteSheet(img,     32,98,     366,102, 1);

                                 // x1   y1   x2   y2  durations in object format
      submarine = sSub.Animation(['0-6', 0, '5-1', 0], { 0: 1,
                                                        '1-5': 0.1,
                                                         6: 1,
                                                        '7-11': 0.1
                                                       });

      // equivalent to this:       (Notice the 1s        here                      and here)
      //submarine = sSub.Animation(['0-6', 0, '5-1', 0], [1, 0.1, 0.1, 0.1, 0.1, 0.1, 1, 0.1, 0.1, 0.1, 0.1, 0.1]);
    };

    luv.update = function(dt) {
      if(!luv.media.isLoaded()) { return; }

      for(var i=0; i < fighters.length; i++) {
        fighters[i].update(dt);
      }

      lockHeed.update(dt);
      hydro.update(dt);
      submarine.update(dt);

      lockHeedAngle += dt;
      hydroAngle    -= dt;

      // Not recommended when displaying rotated or centered images
      // luv.graphics.setImageSmoothing(false);
    };

    luv.draw = function() {

      if(!luv.media.isLoaded()) { return; }

      for(var i=0; i < fighters.length; i++) {
        luv.graphics.draw(fighters[i], (i+1)*75, (i+1)*50);
      }

      luv.graphics.drawCentered(lockHeed, 100, 432, 1,1, lockHeedAngle);
      luv.graphics.drawCentered(hydro,    250, 432, 1,1, hydroAngle);

      luv.graphics.draw(submarine, 500, 100);
    };

    luv.run();
  </script>
</body>
</html>
